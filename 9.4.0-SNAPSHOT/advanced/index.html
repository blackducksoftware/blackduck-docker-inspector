



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Advanced - Black Duck Docker Inspector</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#how-black-duck-docker-inspector-discovers-dependencies" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Black Duck Docker Inspector" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Black Duck Docker Inspector
            </span>
            <span class="md-header-nav__topic">
              
                Advanced
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Black Duck Docker Inspector" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Black Duck Docker Inspector
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Documentation" class="md-nav__link">
      <b>Documentation</b>
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quickstart/" title="Quick start" class="md-nav__link">
      Quick start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../running/" title="Running" class="md-nav__link">
      Running
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../properties/" title="Properties" class="md-nav__link">
      Properties
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Advanced
      </label>
    
    <a href="./" title="Advanced" class="md-nav__link md-nav__link--active">
      Advanced
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-black-duck-docker-inspector-discovers-dependencies" class="md-nav__link">
    How Black Duck Docker Inspector discovers dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-file-sharing-in-docker" class="md-nav__link">
    Enabling file sharing in Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isolating-application-components" class="md-nav__link">
    Isolating application components
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations-to-this-feature" class="md-nav__link">
    Limitations to this feature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-this-feature" class="md-nav__link">
    How to use this feature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-windows-images-on-non-windows-systems" class="md-nav__link">
    Inspecting Windows images on non-Windows systems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-multiple-images-more-efficiently-by-leaving-services-running" class="md-nav__link">
    Inspecting multiple images more efficiently by leaving services running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concurrent-execution" class="md-nav__link">
    Concurrent execution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternative-methods-for-setting-property-values" class="md-nav__link">
    Alternative methods for setting property values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#passing-passwords-and-other-values-with-increased-security" class="md-nav__link">
    Passing passwords and other values with increased security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#air-gap-mode" class="md-nav__link">
    Air Gap mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-black-duck-docker-inspector-for-your-docker-engine-and-registry" class="md-nav__link">
    Configuring Black Duck Docker Inspector for your Docker Engine and registry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-synopsys-detect-on-a-project-directory-that-exists-within-a-docker-image" class="md-nav__link">
    Running Synopsys Detect on a project directory that exists within a Docker image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-signature-scanner-on-a-specific-directory-within-a-docker-image" class="md-nav__link">
    Running the signature scanner on a specific directory within a Docker image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excluding-filesdirectories-from-the-returned-container-file-system-which-excludes-them-from-synopsys-detects-signature-scan" class="md-nav__link">
    Excluding files/directories from the returned container file system which excludes them from Synopsys Detect's signature scan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relocating-black-duck-docker-inspectors-working-directories" class="md-nav__link">
    Relocating Black Duck Docker Inspector's working directories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-image-support" class="md-nav__link">
    OCI Image support
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../deployment/" title="Deploying" class="md-nav__link">
      Deploying
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releasenotes/" title="Release notes" class="md-nav__link">
      Release notes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-black-duck-docker-inspector-discovers-dependencies" class="md-nav__link">
    How Black Duck Docker Inspector discovers dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-file-sharing-in-docker" class="md-nav__link">
    Enabling file sharing in Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isolating-application-components" class="md-nav__link">
    Isolating application components
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations-to-this-feature" class="md-nav__link">
    Limitations to this feature
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-this-feature" class="md-nav__link">
    How to use this feature
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-windows-images-on-non-windows-systems" class="md-nav__link">
    Inspecting Windows images on non-Windows systems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-multiple-images-more-efficiently-by-leaving-services-running" class="md-nav__link">
    Inspecting multiple images more efficiently by leaving services running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concurrent-execution" class="md-nav__link">
    Concurrent execution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternative-methods-for-setting-property-values" class="md-nav__link">
    Alternative methods for setting property values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#passing-passwords-and-other-values-with-increased-security" class="md-nav__link">
    Passing passwords and other values with increased security
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#air-gap-mode" class="md-nav__link">
    Air Gap mode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-black-duck-docker-inspector-for-your-docker-engine-and-registry" class="md-nav__link">
    Configuring Black Duck Docker Inspector for your Docker Engine and registry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-synopsys-detect-on-a-project-directory-that-exists-within-a-docker-image" class="md-nav__link">
    Running Synopsys Detect on a project directory that exists within a Docker image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-signature-scanner-on-a-specific-directory-within-a-docker-image" class="md-nav__link">
    Running the signature scanner on a specific directory within a Docker image
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excluding-filesdirectories-from-the-returned-container-file-system-which-excludes-them-from-synopsys-detects-signature-scan" class="md-nav__link">
    Excluding files/directories from the returned container file system which excludes them from Synopsys Detect's signature scan
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relocating-black-duck-docker-inspectors-working-directories" class="md-nav__link">
    Relocating Black Duck Docker Inspector's working directories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oci-image-support" class="md-nav__link">
    OCI Image support
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Advanced</h1>
                
                <p>This section covers a variety of advanced topics.</p>
<h3 id="how-black-duck-docker-inspector-discovers-dependencies">How Black Duck Docker Inspector discovers dependencies</h3>
<p>Black Duck Docker Inspector discovers dependencies in the target image by making a request to
an image inspector service (running inside a container).
The image inspector service works as follows:</p>
<ol>
<li>Reads the target image, and constructs the file system that the container would have at
time zero if you were to run the image.</li>
<li>Finds the linux package manager database in that file system.</li>
<li>Runs its own linux package manager (invoking its "list" function: "dpkg -l", "rpm -qa --qf ...", or "apk info -v") on the package manager
database from the target image
to generate the list of packages installed in the target image.
If the package manager database type of the target image does not match
the image inspector's package manager type, the image inspector will redirect
the request
to the image inspector that can process the target image (which starts
again at step 1).</li>
<li>Translates that package list to BDIO and uploads it to Black Duck, or returns it to the the
caller (e.g. Synopsys Detect) to upload to Black Duck.</li>
<li>Returns the constructed file system to the caller (e.g. Synopsys Detect) for signature scanning.</li>
</ol>
<p>The user ID and group ID of the image inspector service process will (in general) be different from the user ID and
group ID of the Black Duck Docker Inspector process. Consequently, the the environment must be confugred
so that files created by Black Duck Docker Inspector are readable by all. On Linux, this means an appropriate
umask value (for example 002 or 022). On Windows, the working directory must be readable by all.
In addition, the permissions on a Docker tarfile passed via
the <em>docker.tar</em> property must allow read by all.</p>
<h3 id="enabling-file-sharing-in-docker">Enabling file sharing in Docker</h3>
<p>Docker may restrict file sharing to certain directories that you've configured in
Docker &gt; Settings &gt; Resource &gt; File Sharing. To enable Black Duck Docker Inspector to mount the volumes
that it needs, you may need to enabling file sharing for directory $HOME/blackduck.</p>
<h3 id="isolating-application-components">Isolating application components</h3>
<p>If you are interested in components from the application layers of your image, but not interested in components
from the underlying platform layers, you can exclude components from platform layers from your results.</p>
<p>For example, if you build your application on <em>ubuntu:latest</em> (your Dockerfile starts
with FROM ubuntu:latest), you can exclude components from the Ubuntu layer(s) so that
the components generated by Black Duck Docker Inspector contain only components from your application layers.</p>
<h4 id="limitations-to-this-feature">Limitations to this feature</h4>
<p>This feature works when the method you use to build your image adds layers
on top of a base or platform image (single-stage builds).
Here's an example of a Dockerfile that adds layers on top of a base image. This feature will work
for images built this way:</p>
<pre><code>FROM ubuntu:latest
RUN apt-get update &amp;&amp; apt-get -y install curl
</code></pre>
<p>The resulting image will include all layers from ubuntu:latest, plus an additional layer
that adds the curl package. This feature is designed for this type of image, and will
be able to isolate the layers added to ubuntu:latest (which in this case is a single
layer that adds curl).</p>
<p>On the other hand, when you build an image using multiple FROM statements in the Dockerfile
(multi-stage builds),
the layers in the resulting image are not, in general, the layers of the first image
followed by the layers of the second image. You can verify this by comparing
the <em>RootFS.Layers</em> list of the resulting image to the <em>RootFS.Layers</em> lists of the images
named in the FROM statements. (See below for instructions on how to get the RootFS.Layers list
using the <em>docker inspect</em> command).</p>
<p>Here's an example of a Dockerfile that uses
multiple FROM statements. This feature will not, in general, work for images built this way:</p>
<pre><code>FROM ubuntu:latest
FROM myapplicationimage:mytag
</code></pre>
<h4 id="how-to-use-this-feature">How to use this feature</h4>
<p>First, find the layer ID of the platform's top layer using the following process.</p>
<ol>
<li>Run the <em>docker inspect</em> command on the platform image. In this example, the platform image is ubuntu:latest,
so you would run <code>docker inspect ubuntu:latest</code>.</li>
<li>Find the last element in the <em>RootFS.Layers</em> array. This is the platform top layer ID. In the following example, this is 
sha256:b079b3fa8d1b4b30a71a6e81763ed3da1327abaf0680ed3ed9f00ad1d5de5e7c. (Because the <em>latest</em> tag moves frequently,
the top layer ID for ubuntu:latest changes over time.)</li>
</ol>
<p>Set the value of the Black Duck Docker Inspector property <em>docker.platform.top.layer.id</em> to the platform top layer ID.
For example:</p>
<pre><code>./blackduck-docker-inspector.sh ... --docker.platform.top.layer.id=sha256:b079b3fa8d1b4b30a71a6e81763ed3da1327abaf0680ed3ed9f00ad1d5de5e7c
</code></pre>
<p>In this mode, the container file system and/or container file system squashed image produced by Black Duck Docker Inspector
 only contains files added to the image by application layers. If the Black Duck signature scanner is run on this file,
it generates results based only on files found on application layers. This provides the benefit of isolating
application components by excluding platform components. However, there may be some loss in match accuracy from the
signature scanner because in this scenario, the signature scanner may be deprived of some contextual
information, such as the operating system files that enable it to determine the Linux distribution.<br />
This could negatively affect its ability to accurately identify components.</p>
<h3 id="inspecting-windows-images-on-non-windows-systems">Inspecting Windows images on non-Windows systems</h3>
<p>Running on a non-Windows system, Docker can neither pull nor build a Windows image.
Consequently, you cannot run Black Duck Docker Inspector on a Windows Docker image
using the either the <em>docker.image</em> or <em>docker.image.id</em> property.
Instead, you must, using a Windows system,
pull and save the target image as a .tar file, and pass that .tar file
to Black Duck Docker Inspector using the <em>docker.tar</em> property. </p>
<h3 id="inspecting-multiple-images-more-efficiently-by-leaving-services-running">Inspecting multiple images more efficiently by leaving services running</h3>
<p>By default, Black Duck Docker Inspector starts, uses, and then stops and removes either one or two containerized
image inspector services per run. This may be appropriate when scanning
a single image, but when scanning many images it is highly inefficient,
and it doesn't support concurrent execution of multiple Black Duck Docker Inspector runs. </p>
<p>The scanning of many images is completed significantly faster by starting the image inspector services
once, and running multiple instances of Black Duck Docker Inspector, so that each one sends requests to the already-running
image inspector services.</p>
<p>The following script illustrates how this is done in a Docker environment:</p>
<pre><code>curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/docker/batchedImageInspection.sh
</code></pre>
<p>To keep the example simple, this script only starts the Alpine image inspector service.
In general, you must start two more services: the Ubuntu image inspector service
for inspecting images built from dpkg-based Linux distros, and the CentOS image inspector service
for inspecting images built from rpm-based Linux distributions. It doesn't matter which service receives
the request; any service redirects if necessary.</p>
<h3 id="concurrent-execution">Concurrent execution</h3>
<p>You can inspect multiple images in parallel on the same computer if you (a) directly invoke the .jar file, and (b) leave the services running. For example:</p>
<pre><code># Get the latest blackduck-docker-inspector.sh
curl -O  https://blackducksoftware.github.io/blackduck-docker-inspector/blackduck-docker-inspector.sh
chmod +x ./blackduck-docker-inspector.sh

# Determine the current Black Duck Docker Inspector version
inspectorVersion=$(grep "^version=" blackduck-docker-inspector.sh|cut -d'"' -f2)

# Download the latest Black Duck Docker Inspector .jar file to the current dir
./blackduck-docker-inspector.sh --pulljar

# Execute multiple inspections in parallel
java -jar ./blackduck-docker-inspector-${inspectorVersion}.jar --blackduck.url={Black Duck url} --blackduck.username={Black Duck username} --docker.image=alpine:3.5 --cleanup.inspector.container=false &amp;
# Allow time for the image inspector service to start before starting the rest of the runs (do this for each image inspector type that you use: alpine, centos, ubuntu)
java -jar ./blackduck-docker-inspector-${inspectorVersion}.jar --blackduck.url={Black Duck url} --blackduck.username={Black Duck username} --docker.image=alpine:3.4 --cleanup.inspector.container=false &amp;
java -jar ./blackduck-docker-inspector-${inspectorVersion}.jar --blackduck.url={Black Duck url} --blackduck.username={Black Duck username} --docker.image=alpine:3.3 --cleanup.inspector.container=false &amp;
</code></pre>
<h3 id="alternative-methods-for-setting-property-values">Alternative methods for setting property values</h3>
<p>Black Duck Docker Inspector gets its property values from
<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html">Spring Boot's configuration mechanism</a>.
Black Duck Docker Inspector users can leverage Spring Boot capabilities beyond command line arguments
and environment variables; for example, hierarchy of property files and placeholders
to manage properties in more sophisticated ways.</p>
<h3 id="passing-passwords-and-other-values-with-increased-security">Passing passwords and other values with increased security</h3>
<p>For greater security, sensitive property values such as passwords can be set through the environment variables
using one of the Spring Boot configuration mechanisms previously mentioned.</p>
<p>For example, instead of passing <em>--blackduck.password=mypassword</em> on the command line, you can do the following:</p>
<pre><code>export BLACKDUCK_PASSWORD=mypassword
./blackduck-docker-inspector.sh --blackduck.url=http://blackduck.mydomain.com:8080/ --blackduck.username=myusername --docker.image=ubuntu:latest
</code></pre>
<p>Refer to <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html">Spring Boot's configuration mechanism</a>
for more information.</p>
<h3 id="air-gap-mode">Air Gap mode</h3>
<p>In Black Duck Docker Inspector versions 6.2.0 and higher, Black Duck provides an archive containing all files required
to run Black Duck Docker Inspector without requiring access to the internet. To download the Air Gap archive, run the command:</p>
<pre><code>./blackduck-docker-inspector.sh --pullairgapzip
</code></pre>
<p>To create the Docker images from the Air Gap archive required by Black Duck Docker Inspector, run the commands:</p>
<pre><code>unzip blackduck-docker-inspector-{version}-air-gap.zip
docker load -i blackduck-imageinspector-alpine.tar
docker load -i blackduck-imageinspector-centos.tar
docker load -i blackduck-imageinspector-ubuntu.tar
</code></pre>
<p>To run in Air Gap mode, use the command:</p>
<pre><code>./blackduck-docker-inspector.sh --upload.bdio=false --jar.path=./blackduck-docker-inspector-{version}.jar --docker.tar={tarfile}
</code></pre>
<h3 id="configuring-black-duck-docker-inspector-for-your-docker-engine-and-registry">Configuring Black Duck Docker Inspector for your Docker Engine and registry</h3>
<p>If you invoke Black Duck Docker Inspector with an image reference; in other words, a repo:tag value versus a .tar file,
it uses the <a href="https://github.com/docker-java/docker-java">docker-java library</a> to access the Docker registry to pull the image.</p>
<p>If you can pull an image using <em>docker pull</em> from the command line, then you will be able to configure Black Duck Docker Inspector to pull that image.
The docker-java library can often be configured the same way as the Docker command line utility (<em>docker</em>).</p>
<p>There are also other ways to configure docker-java. For more information on configuring docker-java
(and therefore Black Duck Docker Inspector) for your Docker registry,
refer to the <a href="https://github.com/docker-java/docker-java/blob/master/docs/getting_started.md">docker-java configuration documentation</a>.</p>
<p>For example, one way to configure your Docker registry username and password is to create a file
in your home directory named <em>.docker-java.properties</em> that configures username and password:</p>
<pre><code>registry.username=mydockerhubusername
registry.password=mydockerhubpassword
</code></pre>
<p>If you need to override the DOCKER_HOST value, set property <em>use.platform.default.docker.host</em> to false.
When <em>use.platform.default.docker.host</em> is set to false,
Black Duck Docker Inspector does not override any of the configuration settings in the code,
so all other docker-java configuration methods such as properties, system properties,
and system environment, are available to you.</p>
<p>When <em>use.platform.default.docker.host</em> is set to true (the default value) <em>and</em> Black Duck Docker Inspector is running
on Windows, Black Duck Docker Inspector overrides only the DOCKER_HOST value
(setting it to "npipe:////./pipe/docker_engine").</p>
<h3 id="running-synopsys-detect-on-a-project-directory-that-exists-within-a-docker-image">Running Synopsys Detect on a project directory that exists within a Docker image</h3>
<p>When you want to run Synopsys Detect on a directory that exists within a Docker image, you can use the following approach:
1. Run Synopsys Detect on the image to generate the container filesystem for the image.
2. Run Synopsys Detect on a directory within that container filesystem.</p>
<p>Synopsys Detect performs these actions without running the image/container.</p>
<p>To see a simple example that illustrates this approach, use the following commands to download these sample files:</p>
<pre><code>curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/docker/runDetectInImageDir/runDetectInImageDir.sh
curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/docker/runDetectInImageDir/Dockerfile
</code></pre>
<p>Review the script before running it to make sure the side effects
(files and directories that it creates) are acceptable.
You must make the script executable before you run it. </p>
<h3 id="running-the-signature-scanner-on-a-specific-directory-within-a-docker-image">Running the signature scanner on a specific directory within a Docker image</h3>
<p>To use iScan to scan a specific directory within an image:</p>
<ol>
<li>Run Black Duck Docker Inspector on the target image to get the container file system.
You can also do this using Synopsys Detect using <code>--detect.docker.passthrough.*</code> properties.
Include the following Black Duck Docker Inspector properties:</li>
</ol>
<pre><code>--upload.bdio=false                        # disable BDIO upload
--output.include.containerfilesystem=true  # tell DI to output the container file system
--output.path={your output dir}            # tell DI where to put the output
</code></pre>
<ol>
<li>Locate the container file system in the output directory (*.tar.gz) and untar it.</li>
<li>cd into the directory within the untared container file system that you want to scan.</li>
<li>Invoke Synopsys Detect there.</li>
</ol>
<h3 id="excluding-filesdirectories-from-the-returned-container-file-system-which-excludes-them-from-synopsys-detects-signature-scan">Excluding files/directories from the returned container file system which excludes them from Synopsys Detect's signature scan</h3>
<p>To exclude certain files and/or directories from the returned file system, you can
specify that list of directories with the property <em>--output.containerfilesystem.excluded.paths</em>.</p>
<p>For example, if you are invoking Black Duck Docker Inspector from Synopsys Detect, and want Synopsys Detect
to exclude the <em>/etc</em> and <em>/usr/bin</em> directories from the signature scan, you
could run Synopsys Detect like this:</p>
<pre><code>./detect.sh --detect.docker.image=ubuntu:latest --detect.docker.passthrough.output.containerfilesystem.excluded.paths=/etc,/usr/bin
</code></pre>
<h3 id="relocating-black-duck-docker-inspectors-working-directories">Relocating Black Duck Docker Inspector's working directories</h3>
<p>Docker Inspector uses 3 directories:</p>
<ol>
<li>One that blackduck-docker-inspector.sh downloads the Black Duck Docker Inspector .jar file into (controlled via environment variable DOCKER_INSPECTOR_JAR_DIR)</li>
<li>One that Black Duck Docker Inspector shares with its image inspector containers (controlled via the shared.dir.path.local property)</li>
<li>One for other files (controlled via properety working.dir.path)</li>
</ol>
<p>By default, Black Duck Docker Inspector creates a temporary directory under /tmp for each purpose, but each directory can be relocated.
If you want to avoid /tmp, you could relocate all three by doing something similar to this:</p>
<pre><code># mkdir /opt/tmp/jar # Create a dir for the Black Duck Docker Inspector .jar download
# mkdir /opt/tmp/working # Create a dir Black Duck Docker Inspector working dir
# mkdir /opt/tmp/shared # Create a dir that Black Duck Docker Inspector will share with its image inspector containers
export DOCKER_INSPECTOR_JAR_DIR=/opt/tmp/jar
./blackduck-docker-inspector.sh --working.dir.path=/opt/tmp/working --shared.dir.path.local=/opt/tmp/shared ...
</code></pre>
<h3 id="oci-image-support">OCI Image support</h3>
<p>Black Duck Docker Inspector supports <a href="https://github.com/opencontainers/image-spec/blob/main/spec.md">OCI image</a> archives (.tar files)
passed to it via the docker.tar property.</p>
<p>Black Duck Docker Inspector derives the image repo:tag value for each manifest in the index.json file from an
annotation with key 'org.opencontainers.image.ref.name' if it is present.</p>
<p>If the OCI archive contains multiple images, Black Duck Docker Inspector constructs the target repo:tag from the values of properties docker.image.repo
and docker.image.tag (if docker.image.tag is not set it defaults to "latest"), and looks for a manifest annotation with key 'org.opencontainers.image.ref.name'
that has value matching the constructed target repo:tag. If a match is found, Black Duck Docker Inspector inspects the matching image. If no match is found, or docker.image.repo
is not set, Black Duck Docker Inspector fails.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../properties/" title="Properties" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Properties
              </span>
            </div>
          </a>
        
        
          <a href="../deployment/" title="Deploying" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploying
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>