



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Deploying - Black Duck Docker Inspector</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#deployment-overview" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Black Duck Docker Inspector" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Black Duck Docker Inspector
            </span>
            <span class="md-header-nav__topic">
              
                Deploying
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Black Duck Docker Inspector" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Black Duck Docker Inspector
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../running/" title="Running" class="md-nav__link">
      Running
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../properties/" title="Properties" class="md-nav__link">
      Properties
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Deploying
      </label>
    
    <a href="./" title="Deploying" class="md-nav__link md-nav__link--active">
      Deploying
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment-overview" class="md-nav__link">
    Deployment overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-notes-regarding-deployment-sample-code" class="md-nav__link">
    Important notes regarding deployment sample code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-host-mode-on-a-linux-machine-or-linux-vm-with-docker" class="md-nav__link">
    Using host mode on a Linux machine or Linux VM with Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-container-mode-in-a-container-orchestration-platform-such-as-kubernetes-openshift-and-others" class="md-nav__link">
    Using container mode in a container orchestration platform such as Kubernetes, OpenShift, and others
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image-inspector-services" class="md-nav__link">
    Image Inspector Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-kubernetes" class="md-nav__link">
    Deployment sample for Kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-openshift" class="md-nav__link">
    Deployment sample for OpenShift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-travis-ci" class="md-nav__link">
    Deployment sample for Travis CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-gitlab-ci" class="md-nav__link">
    Deployment sample for GitLab CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-circle-ci" class="md-nav__link">
    Deployment sample for Circle CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-docker-with-detect-running-in-a-container" class="md-nav__link">
    Deployment sample for Docker with Detect running in a container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-black-duck-docker-inspector-for-your-docker-registry" class="md-nav__link">
    Configuring Black Duck Docker Inspector for your Docker registry
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releasenotes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deployment-overview" class="md-nav__link">
    Deployment overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-notes-regarding-deployment-sample-code" class="md-nav__link">
    Important notes regarding deployment sample code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-host-mode-on-a-linux-machine-or-linux-vm-with-docker" class="md-nav__link">
    Using host mode on a Linux machine or Linux VM with Docker
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-container-mode-in-a-container-orchestration-platform-such-as-kubernetes-openshift-and-others" class="md-nav__link">
    Using container mode in a container orchestration platform such as Kubernetes, OpenShift, and others
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image-inspector-services" class="md-nav__link">
    Image Inspector Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-kubernetes" class="md-nav__link">
    Deployment sample for Kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-openshift" class="md-nav__link">
    Deployment sample for OpenShift
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-travis-ci" class="md-nav__link">
    Deployment sample for Travis CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-gitlab-ci" class="md-nav__link">
    Deployment sample for GitLab CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-circle-ci" class="md-nav__link">
    Deployment sample for Circle CI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-sample-for-docker-with-detect-running-in-a-container" class="md-nav__link">
    Deployment sample for Docker with Detect running in a container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-black-duck-docker-inspector-for-your-docker-registry" class="md-nav__link">
    Configuring Black Duck Docker Inspector for your Docker registry
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Deploying</h1>
                
                <h3 id="deployment-overview">Deployment overview</h3>
<p>Black Duck Docker Inspector can be run in either of the following modes:</p>
<ol>
<li>Host mode on a Linux machine or a Linux virtual machine (VM) with Docker. The deployment approach for host mode is referred to below as "utility"; you simply execute a command, and deployment is automatic.</li>
<li>Container mode inside a container running on an orchestration platform such as Kubernetes, OpenShift, etc. The deployment approach for container mode is referred to below as "toolkit"; you take components provided by Docker Inspector (one utility, three containerized services) and deploy them yourself.</li>
</ol>
<p>Most, but not all, of the deployment examples below use the toolkit approach.</p>
<h3 id="important-notes-regarding-deployment-sample-code">Important notes regarding deployment sample code</h3>
<p>The deployment samples provided are intended to illustrate possible approaches to the challenges
involved in deploying Black Duck Docker Inspector. They are not intended to be used as-is in production.
You should understand the code before you use it. They do not represent the only way to deploy in each environment.</p>
<p>Your deployment approach is the same whether you are invoking Black Duck Docker Inspector directly, or invoking it using Detect.
Most of the sample deployments use Detect simply because that is the most common use case.</p>
<h3 id="using-host-mode-on-a-linux-machine-or-linux-vm-with-docker">Using host mode on a Linux machine or Linux VM with Docker</h3>
<p>In this scenario, Black Duck Docker Inspector is a command line utility that automatically pulls/runs and uses container-based services,<br />
and cleans them up when it's done. The Docker command, if installed on the machine, can be very useful for troubleshooting, but is not actually
required or used by Black Duck Docker Inspector.</p>
<p>In this mode, Black Duck Docker Inspector does require access to a Docker Engine, similar to the way the Docker client requires
access to a Docker Engine, so it can pull and run Docker images. It uses the https://github.com/docker-java/docker-java
library to perform Docker operations using the Docker Engine.</p>
<p>In this mode, Black Duck Docker Inspector automatically pulls, runs, stops, and removes the container-based image inspector services
on which it depends. It accesses the services they provide through HTTP GET operations.</p>
<p>This is the default mode, and the simplest to use.</p>
<h3 id="using-container-mode-in-a-container-orchestration-platform-such-as-kubernetes-openshift-and-others">Using container mode in a container orchestration platform such as Kubernetes, OpenShift, and others</h3>
<p>In this scenario, Black Duck Docker Inspector is a toolkit consisting of a command line utility that you run in one container, plus
three container-based services which you must start. These four containers must:
(a) share a mounted volume, either persistent or temporary, used to pass large files between containers, and
(b) be able to reach each other through HTTP GET operations using base URLs that you provide.</p>
<h3 id="image-inspector-services">Image Inspector Services</h3>
<p>Black Duck Docker Inspector consists of a command line utility provided in a Java .jar, but sometimes invoked using a bash script,
and three image inspector services.</p>
<p>The required Docker operations, if any, are performed by the command line utility, while the image inspector services
perform the work of unpacking the target Docker image, extracting the Linux package manager database,
and running the Linux package manager against that database to extract installed packages
and translate them to components which are actually externalIDs, for Black Duck. If the image inspector service
finds in the target image a package manager database that is incompatible with its own package manager utility; for example, 
when you run Black Duck Docker Inspector on an Alpine image, but the request goes to the
Ubuntu image inspector service, the image inspector service redirects the request to the appropriate
image inspector service. You can change the default image inspector service to reduce the likelihood
of redirects, resulting in shorter execution times. For example, if most of your target images are Alpine
you can set <em>imageinspector.service.distro.default</em> to alpine.</p>
<p>The image inspector service containers are downloaded from Docker Hub (blackducksoftware/blackduck-imageinspector-*).</p>
<h3 id="deployment-sample-for-kubernetes">Deployment sample for Kubernetes</h3>
<p>Approach: Toolkit</p>
<p>Deployment notes: Each image inspector service runs in a separate pod.
The shared volume is a hostPath volume. The containers communicate through service URLs.</p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/kubernetes/setup.txt</p>
<h3 id="deployment-sample-for-openshift">Deployment sample for OpenShift</h3>
<p>Approach: Toolkit</p>
<p>Deployment notes: All image inspector services run in a single pod. The shared volume is an <em>emptyDir</em> volume.
The containers communicate through localhost URLs.</p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/openshift/setup.txt</p>
<h3 id="deployment-sample-for-travis-ci">Deployment sample for Travis CI</h3>
<p>Approach: Toolkit</p>
<p>Deployment notes: Uses the Travis CI docker service.
The containers communicate through localhost URLs.</p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/travisci/travis.yml</p>
<h3 id="deployment-sample-for-gitlab-ci">Deployment sample for GitLab CI</h3>
<p>Approach: Toolkit</p>
<p>Deployment notes: Uses the GitLab CI shell executor.
The containers communicate through localhost URLs.</p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/gitlabci/setup.sh</p>
<h3 id="deployment-sample-for-circle-ci">Deployment sample for Circle CI</h3>
<p>Approach: Utility</p>
<p>Deployment notes: </p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/circleci/config.yml</p>
<h3 id="deployment-sample-for-docker-with-detect-running-in-a-container">Deployment sample for Docker with Detect running in a container</h3>
<p>Approach: Toolkit</p>
<p>Deployment notes: The containers communicate through localhost URLs.</p>
<p>Download: curl -O https://raw.githubusercontent.com/blackducksoftware/blackduck-docker-inspector/master/deployment/docker/runDetectInContainer/setup.sh         </p>
<h3 id="configuring-black-duck-docker-inspector-for-your-docker-registry">Configuring Black Duck Docker Inspector for your Docker registry</h3>
<p>If you invoke Black Duck Docker Inspector with an image reference, versus an image that has been saved to a .tar file,
it uses the docker-java library (https://github.com/docker-java/docker-java) to access the Docker registry
to pull the image. </p>
<p>If <em>docker pull {targetimage}</em> works from the command line, then Black Duck Docker Inspector is also able
to pull that image, because docker-java can be configured the same way as the Docker command line utility. </p>
<p>There are other ways to configure docker-java. For more information on configuring docker-java
and Black Duck Docker Inspector for your Docker registry, refer to: https://github.com/docker-java/docker-java#Configuration.</p>
<p>Black Duck Docker Inspector does not override any of the configuration settings in the code,
so any of the other methods (properties, system properties, system environment) will work.</p>
<p>If you choose to use environment variables, and you are calling Black Duck Docker Inspector from Detect,
you must prefix the environment variable names with <em>DETECT_DOCKER_PASSTHROUGH_</em> to
instruct Detect to pass them on to Black Duck Docker Inspector.
In that scenario, instead of <em>export SOMENAME=value</em>, use <em>export DETECT_DOCKER_PASSTHROUGH_SOMENAME=value</em>.</p>
<p>If you choose to use system properties which are normally set using <em>java -D</em>,
and you are calling Black Duck Docker Inspector from Detect, you must
put the properties in a file; for example, <em>mydockerproperties.properties</em>, and use </p>
<pre><code>--detect.docker.passthrough.system.properties.path=mydockerproperties.properties
</code></pre>

<p>to point Black Duck Docker Inspector to those property settings.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../advanced/" title="Advanced" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Advanced
              </span>
            </div>
          </a>
        
        
          <a href="../troubleshooting/" title="Troubleshooting" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Troubleshooting
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>